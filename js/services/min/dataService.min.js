soccerStats.factory("dataService",function(e,t,a,r){var o={U12:"U12",U16:"U16",U18:"U18",U20:"U20",U23:"U23"},s={AL:"Alabama",AK:"Alaska",AZ:"Arizona",AR:"Arkansas",CA:"California",CO:"Colorado",CT:"Connecticut",DE:"Delaware",DC:"District Of Columbia",FL:"Florida",GA:"Georgia",HI:"Hawaii",ID:"Idaho",IL:"Illinois",IN:"Indiana",IA:"Iowa",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",ME:"Maine",MD:"Maryland",MA:"Massachusetts",MI:"Michigan",MN:"Minnesota",MS:"Mississippi",MO:"Missouri",MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NY:"New York",NC:"North Carolina",ND:"North Dakota",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PA:"Pennsylvania",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VT:"Vermont",VA:"Virginia",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming"},n=function(){return Parse.User.current()},i={},u=Parse.Object.extend("Players"),l=Parse.Object.extend("_User"),c=Parse.Object.extend("Team"),g=Parse.Object.extend("SeasonPlayerStats"),m=Parse.Object.extend("Game"),d=(Parse.Object.extend("SeasonTeamStats"),function(e){i=e}),y=function(){return i},f=function(e){var a=[],o=new Parse.Query(l),s=Parse.User.current();return o.include("teams"),o.get(s.id,{success:function(r){t(function(){var t=r.get("teams");_.each(t,function(e){var t=e.get("leagueName"),r=e.get("logo"),o=e.get("name"),s=e.get("ageGroup"),n=e.get("city"),i=e.get("number"),u=e.get("state"),l=e.get("primaryColor");a.push({league:t,id:e.id,label:o,logo:r._url,age:s,city:n,number:i,state:u,color:l})}),e(a)})},error:function(e,t){r.error("There was an error ("+t.code+"). Please try again.")}}),a},h=function(e){var a=[],r=Parse.User.current(),o=new Parse.Query(l);return o.include("players"),o.get(r.id,{success:function(r){t(function(){var t=r.get("players");_.each(t,function(e){var t=e.get("photo"),r=e.get("name"),o=e.get("birthday"),s=e.get("team"),n=e.get("jerseyNumber"),i=e.get("city"),u=e.get("state"),l={emergencyContact:e.get("emergencyContact"),phone:e.get("phone"),relationship:e.get("relationship")};a.push({photo:t,name:r,birthday:o,team:s,jerseyNumber:n,city:i,state:u,contact:l,id:e.id})}),e(a)})},error:function(){}}),a},p=function(e,a){var o=new Parse.Query(c);o.equalTo("objectId",e),o.first({success:function(e){t(function(){a(e)})},error:function(e,t){r.error("There was an error ("+t.code+"). Please try again.")}})},b=function(e){var t=new c;return t.set("ageGroup",e.ageGroup),t.set("city",e.city),t.set("leagueName",e.leagueName),t.set("name",e.name),t.set("number",e.number),t.set("state",_.invert(s)[e.state]),t.set("logo",e.logo),t.set("primaryColor",e.primaryColor),t},T=function(e,a){var o=new Parse.Query(u);o.equalTo("team",{__type:"Pointer",className:"Team",objectId:e}),o.find({success:function(e){t(function(){a(e)})},error:function(e,t){r.error("There was an error ("+t.code+"). Please try again.")}})},P=function(e,a){var o=new Parse.Query(g);o.equalTo("player",{__type:"Pointer",className:"Players",objectId:e}),o.first({success:function(e){t(function(){a(e)})},error:function(e,t){r.error("There was an error ("+t.code+"). Please try again.")}})},v=function(e,t){var a=new c,o=new Parse.Query(m);a.id=e.id,a.fetch().then(function(e){o.equalTo("team",e),o.include("gameTeamStats"),o.find().then(function(a){for(var r,o=[],s=0;s<a.length;s++)r={date:a[s].get("date"),opponent:{name:a[s].get("opponent"),symbol:a[s].get("opponentSymbol"),score:a[s].get("gameTeamStats").get("goalsTaken")},team:{name:e.get("name"),symbol:e.get("symbol"),score:a[s].get("gameTeamStats").get("goalsMade")},status:a[s].get("status")},o.push(r);t(o)},function(e){console.log("Error: "+e.code+" "+e.message),r.error("There was a an error ("+e.code+"). Please try again.")})})},I=function(e,t){var a={id:e.id,photo:e.attributes.photo?e.attributes.photo._url:"./img/player-icon.svg",fname:e.attributes.name,lname:"",number:e.attributes.jerseyNumber,position:"",total:{goals:t.attributes.goals?t.attributes.goals:0,fouls:t.attributes.fouls?t.attributes.fouls:0,playingTime:t.attributes.playingTime?Math.round(t.attributes.playingTime):0,assists:t.attributes.assists?t.attributes.assists:0,yellows:0,reds:0,cardInit:function(e,t){_.each(t.attributes.cards,function(t){"yellow"===t.type?e.yellows++:"red"===t.type&&e.reds++})}},shots:{data:[{value:0,color:"#B4B4B4",highlight:"#B4B4B4",label:"Missed"},{value:0,color:"#5DA97B",highlight:"#5DA97B",label:"Completed"}],accuracy:0,blocks:0,onGoal:0,offGoal:0,goals:0,shotInit:function(e,t){_.each(t.attributes.shots,function(t){e.blocks+=t.blocked,e.onGoal+=t.onGoal,e.offGoal+=t.offGoal,e.goals+=t.goals});var a=e.blocks+e.onGoal+e.offGoal+e.goals;e.accuracy=Math.round((a-e.offGoal)/a*100),e.data[0].value=e.offGoal,e.data[1].value=a}},passes:{data:[{value:0,color:"#B4B4B4",highlight:"#B4B4B4",label:"Turnovers"},{value:0,color:"#5DA97B",highlight:"#5DA97B",label:"Total Passes"}],completion:"0/0",turnovers:0,total:0,passInit:function(e,t){_.each(t.attributes.passes,function(t){e.turnovers+=t.turnovers,e.total+=t.total}),e.completion=e.total-e.turnovers+"/"+e.total,e.data[0].value=e.turnovers,e.data[1].value=e.total}},phone:"(123) 456 7890",emergencyContact:{name:e.attributes.emergencyContact,phone:e.attributes.phone,relationship:e.attributes.relationship}};return t.attributes.cards&&a.total.cardInit(a.total,t),t.attributes.shots&&a.shots.shotInit(a.shots,t),t.attributes.passes&&a.passes.passInit(a.passes,t),a},N=function(e,t){var a=new Parse.Query(c);a.include("teamStats"),a.include("teamStats.topAssists"),a.include("teamStats.topAssists.playerStats"),a.equalTo("objectId",e),a.first().then(function(e){console.log(e.get("teamStats").get("topAssists")),t(e.get("teamStats"))},function(e){console.log("Error: "+e.code+" "+e.message),t({error:"Someting happened"})})},S=function(e,a){var o=new Parse.Query(u);o.equalTo("objectId",e),o.first({success:function(e){t(function(){a(e)})},error:function(e,t){console.log("Error: "+t.code+" "+t.message),r.error("There was a an error ("+t.code+"). Please try again.")}})};return{ageGroups:o,states:s,getTeams:f,getTeamById:p,getPlayersByTeamId:T,setCurrentTeam:d,getCurrentTeam:y,registerTeam:b,getPlayers:h,getCurrentUser:n,getSeasonPlayerStatsByPlayerId:P,getGames:v,playerConstructor:I,getPlayerByPlayerId:S,getSeasonTeamStats:N}});