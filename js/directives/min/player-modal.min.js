soccerStats.directive("playerModal",function(e,t,a,r,n,o,s,c){return{restrict:"E",templateUrl:"./templates/directives/player-modal.html",controller:function(e){var t="playerModal";e.closeModal=function(){n.closeModal(t)},e.states=c.states,e.player={photo:"",name:"Zlatan",birthday:"",team:"",jerseyNumber:"12",city:"Spokane",state:"",emergencyContact:{name:"Alec Moore",phone:"5093336897",relationship:"Father"},newPhoto:""},e.$on(s.messages.updatePlayer,function(t,r){a(function(){r.state&&(e.players=c.getPlayers(function(t){console.log(t);var a=_.find(e.teamDict,function(e){return e.value==t[0].team.id});console.log(a),e.player={photo:t[0].photo._url,name:t[0].name,birthday:t[0].birthday,team:a,jerseyNumber:t[0].jerseyNumber,city:t[0].city,state:e.states[t[0].state],emergencyContact:{name:t[0].contact.emergencyContact,phone:t[0].contact.phone,relationship:t[0].contact.relationship}}}))})}),e.goToPage=function(e){a(function(){n.goToPage(e)})},e.registerPlayer=function(t){if(n.validateAreaByFormName("playerForm")){var a=Parse.User.current(),r=Parse.Object.extend("Players"),c=new r,i=Parse.Object.extend("Team"),l=new Parse.Query(i);l.get(t.team.value,{success:function(r){c.set("photo",t.photo),c.set("name",t.name),c.set("birthday",t.birthday),c.set("team",r),c.set("jerseyNumber",t.jerseyNumber),c.set("city",t.city),c.set("state",_.invert(e.states)[t.state]),c.set("emergencyContact",t.emergencyContact.name),c.set("phone",t.emergencyContact.phone),c.set("relationship",t.emergencyContact.relationship),c.save(null,{success:function(e){a.addUnique("players",e),a.save(null,{success:function(){o.success("Player, "+t.name+", successfully added.")},erorr:function(e,t){o.error("There was a an error ("+t.code+"). Please try again.")}})},error:function(e,t){console.log("Error: "+t.code+" "+t.message),o.error("There was a an error ("+t.code+"). Please try again.")}})},error:function(e,t){o.error("There was a an error ("+t.code+"). Please try again.")}})}else o.error(s.toasts.requiredFields)},e.states=c.states,Parse.User.current()&&(e.teamDict=c.getTeams(function(){}))}}});