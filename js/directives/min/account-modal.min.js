soccerStats.directive("accountModal",function(e,t,s,o,a){return{restrict:"E",templateUrl:"./templates/directives/account-modal.html",controller:function(e,s){var r="accountModal";e.closeModal=function(){s.closeModal(r)},e.states=a.states,e.checkPassword=function(){return e.editUser.newPassword?e.confirmPassword()?!0:!1:!0},e.confirmPassword=function(){return e.editUser.newPassword===e.editUser.confirmPassword};var n=Parse.User.current();e.editUser={firstName:n.get("firstName"),lastName:n.get("lastName"),name:n.get("name"),email:n.get("email"),newPassword:"",confirmPassword:n.get("password"),phone:n.get("phone"),city:n.get("city"),state:e.states[n.get("state")],photo:n.get("photo")._url,newPhoto:""},e.updateAccount=function(a){s.validateAreaByFormName("accountForm")?e.checkPassword()&&(n.set("username",a.email),n.set("firstName",a.firstName),n.set("lastName",a.lastName),n.set("name",a.firstName+" "+a.lastName),n.set("email",a.email),n.set("phone",a.phone),n.set("city",a.city),n.set("state",_.invert(e.states)[a.state]),console.log(a.newPhoto),e.editUser.newPhoto&&n.set("photo",a.newPhoto),n.set("password",a.newPassword),n.save(null,{success:function(){t.success(o.toasts.accountUpdateSuccess),s.goToPage("/home")},error:function(e,s){console.log("Error: "+s.code+" "+s.message),t.error("There was a an error ("+s.code+"). Please try again.")}})):t.error(o.toasts.requiredFields)},e.goToPage=function(e){s.goToPage(e)}}}});