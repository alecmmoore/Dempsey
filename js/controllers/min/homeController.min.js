soccerStats.controller("homeController",function(e,t,a,o,s,l,g,r){e.verified=!1,e.user={name:"",accountType:""},e.myPlayers=[],e.currentTeam={};var n=Parse.User.current();n.fetch()&&(e.user.name=n.get("name"),n.get("emailVerified")?e.verified=!0:s.error(l.toasts.emailVerification)),e.updatePlayer=function(e){r.openModal("playerModal"),a(function(){o.$broadcast(l.messages.updatePlayer,{state:!0,id:e.id})})},e.$on(l.messages.teamChanged,function(t,a){g.getSeasonTeamStats(a.team.id,function(t){t?(e.teamStats={teamGames:{data:[{value:t.get("gamesDraw"),color:"#B4B4B4",highlight:"#B4B4B4",label:"Draws"},{value:t.get("gamesWon"),color:"#5DA97B",highlight:"#5DA97B",label:"Wins"},{value:t.get("gamesDefeat"),color:"#FF7373",highlight:"#FF7373",label:"Losses"}]},goalsConceded:t.get("goalsConceded"),goalsScored:t.get("goalsScored"),avgGoals:t.get("avgGoals"),ballPossession:t.get("ballPossession"),foulsCommitted:t.get("foulsCommitted"),gamesPlayed:t.get("gamesPlayed"),goalsDifference:t.get("goalsScored")-t.get("goalsConceded")>=0?"+".concat(t.get("goalsScored")-t.get("goalsConceded")):"-".concat(t.get("goalsScored")-t.get("goalsConceded")),topAssists:[],topGoals:[],topShots:[]},_.each(t.get("topAssists"),function(t){var a=t.get("photo")?t.get("photo")._url:"./img/sample/profile-small.jpg";e.teamStats.topAssists.push({name:t.get("name"),num:t.get("playerStats").get("assists"),photo:a})}),_.each(t.get("topGoals"),function(t){var a=t.get("photo")?t.get("photo")._url:"./img/sample/profile-small.jpg";e.teamStats.topGoals.push({name:t.get("name"),num:t.get("playerStats").get("goals"),photo:a})}),_.each(t.get("topShots"),function(t){var a=t.get("photo")?t.get("photo")._url:"./img/sample/profile-small.jpg";e.teamStats.topShots.push({name:t.get("name"),num:t.get("playerStats").get("shots").total,photo:a})})):e.teamStats={teamGames:{data:[]},goalsConceded:0,goalsScored:0,avgGoals:0,ballPossession:0,foulsCommitted:0,gamesPlayed:0,goalsDifference:0,topAssists:[],topGoals:[],topShots:[]}})}),e.isCoach=!1,e.$on(l.messages.teamChanged,function(t,a){a.refresh||(e.currentTeam=a.team),e.myPlayers=[],1===n.get("accountType")?g.getPlayersByTeamId(e.currentTeam.id,function(t){_.each(t,function(t){g.getSeasonPlayerStatsByPlayerId(t.get("playerStats").id,function(a){e.myPlayers.push(g.playerConstructor(t,a))})})}):_.each(n.get("players"),function(t){g.getPlayerByPlayerId(t.id,function(t){t.get("team").id===e.currentTeam.id&&g.getSeasonPlayerStatsByPlayerId(t.get("playerStats").id,function(a){e.myPlayers.push(g.playerConstructor(t,a))})})})}),e.$on(l.messages.playerAdded,function(t,a){g.getSeasonPlayerStatsByPlayerId(a.get("playerStats").id,function(t){e.myPlayers.push(g.playerConstructor(a,t))})})});